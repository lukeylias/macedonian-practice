<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Learn Macedonian Cyrillic</title>
    <link rel="icon" type="image/png" href="macedonia_640.png" />
    <link
      href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      :root {
        --bg: #0f1419;
        --card-bg: #1a2332;
        --card-hover: #243447;
        --accent: #f59e0b;
        --accent-soft: rgba(245, 158, 11, 0.15);
        --text: #e8eaed;
        --text-muted: #8899a6;
        --success: #10b981;
        --error: #ef4444;
        --group1: #3b82f6;
        --group2: #f59e0b;
        --group3: #10b981;
        --group4: #8b5cf6;
        --group5: #ef4444;
      }

      body {
        font-family: "Outfit", sans-serif;
        background: var(--bg);
        color: var(--text);
        min-height: 100vh;
        padding: 20px;
        padding-bottom: 100px;
      }

      .container {
        max-width: 600px;
        margin: 0 auto;
      }

      header {
        text-align: center;
        margin-bottom: 30px;
      }

      h1 {
        font-size: 1.8rem;
        font-weight: 700;
        margin-bottom: 8px;
        background: linear-gradient(135deg, var(--accent), #fbbf24);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .subtitle {
        color: var(--text-muted);
        font-size: 0.95rem;
      }

      .tabs {
        display: flex;
        gap: 8px;
        margin-bottom: 24px;
        overflow-x: auto;
        padding-bottom: 8px;
        -webkit-overflow-scrolling: touch;
      }

      .tab {
        padding: 10px 18px;
        background: var(--card-bg);
        border: none;
        border-radius: 20px;
        color: var(--text-muted);
        font-family: inherit;
        font-size: 0.9rem;
        cursor: pointer;
        transition: all 0.2s;
        white-space: nowrap;
        flex-shrink: 0;
      }

      .tab:hover {
        background: var(--card-hover);
      }
      .tab.active {
        background: var(--accent);
        color: var(--bg);
        font-weight: 600;
      }

      .groups {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
        gap: 12px;
        margin-bottom: 24px;
      }

      .group-card {
        background: var(--card-bg);
        border-radius: 16px;
        padding: 20px;
        cursor: pointer;
        transition: all 0.2s;
        border: 2px solid transparent;
      }

      .group-card:hover {
        transform: translateY(-2px);
        background: var(--card-hover);
      }
      .group-card.selected {
        border-color: var(--accent);
      }
      .group-card h3 {
        font-size: 0.85rem;
        color: var(--text-muted);
        margin-bottom: 6px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }
      .group-card .letters {
        font-size: 1.4rem;
        font-weight: 600;
        letter-spacing: 2px;
        margin-bottom: 8px;
      }
      .group-card .count {
        font-size: 0.8rem;
        color: var(--text-muted);
      }

      .group-card[data-group="1"] {
        border-left: 4px solid var(--group1);
      }
      .group-card[data-group="2"] {
        border-left: 4px solid var(--group2);
      }
      .group-card[data-group="3"] {
        border-left: 4px solid var(--group3);
      }
      .group-card[data-group="4"] {
        border-left: 4px solid var(--group4);
      }
      .group-card[data-group="5"] {
        border-left: 4px solid var(--group5);
      }

      .flashcard-container {
        perspective: 1000px;
        margin-bottom: 24px;
      }

      .flashcard {
        width: 100%;
        height: 320px;
        position: relative;
        transform-style: preserve-3d;
        transition: transform 0.5s;
        cursor: pointer;
      }

      .flashcard.flipped {
        transform: rotateY(180deg);
      }

      .flashcard-face {
        position: absolute;
        width: 100%;
        height: 100%;
        backface-visibility: hidden;
        border-radius: 24px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 24px;
      }

      .flashcard-front {
        background: linear-gradient(145deg, var(--card-bg), #1e2d3d);
        border: 1px solid rgba(255, 255, 255, 0.05);
      }

      .flashcard-back {
        background: linear-gradient(145deg, #1e2d3d, var(--card-bg));
        border: 1px solid rgba(255, 255, 255, 0.05);
        transform: rotateY(180deg);
      }

      .flashcard-group-badge {
        position: absolute;
        top: 16px;
        left: 16px;
        padding: 4px 12px;
        border-radius: 12px;
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
      }

      .flashcard-letter {
        font-size: 7rem;
        font-weight: 700;
        margin-bottom: 8px;
        text-shadow: 0 4px 20px rgba(245, 158, 11, 0.3);
      }
      .flashcard-lowercase {
        font-size: 3rem;
        color: var(--text-muted);
        margin-bottom: 12px;
      }
      .flashcard-hint {
        color: var(--text-muted);
        font-size: 0.9rem;
      }
      .flashcard-sound {
        font-size: 3rem;
        font-weight: 600;
        color: var(--accent);
        margin-bottom: 12px;
      }
      .flashcard-example {
        color: var(--text-muted);
        font-size: 1rem;
        text-align: center;
        margin-bottom: 12px;
      }

      .flashcard-trick {
        padding: 10px 16px;
        background: var(--accent-soft);
        border-radius: 12px;
        font-size: 0.85rem;
        color: var(--accent);
        text-align: center;
        max-width: 90%;
      }

      .flashcard-word-example {
        margin-top: 10px;
        padding: 8px 14px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 10px;
        text-align: center;
      }

      .flashcard-word-example .cyrillic {
        font-size: 1.2rem;
        font-weight: 600;
      }
      .flashcard-word-example .meaning {
        font-size: 0.8rem;
        color: var(--text-muted);
        margin-top: 2px;
      }

      .controls {
        display: flex;
        gap: 12px;
        justify-content: center;
        margin-bottom: 24px;
      }

      .btn {
        padding: 14px 28px;
        border: none;
        border-radius: 12px;
        font-family: inherit;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s;
      }

      .btn-primary {
        background: var(--accent);
        color: var(--bg);
      }
      .btn-primary:hover {
        background: #fbbf24;
        transform: translateY(-2px);
      }
      .btn-secondary {
        background: var(--card-bg);
        color: var(--text);
      }
      .btn-secondary:hover {
        background: var(--card-hover);
      }
      .btn-small {
        padding: 8px 16px;
        font-size: 0.85rem;
      }

      .progress-bar {
        height: 6px;
        background: var(--card-bg);
        border-radius: 3px;
        margin-bottom: 16px;
        overflow: hidden;
      }
      .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, var(--accent), #fbbf24);
        border-radius: 3px;
        transition: width 0.3s;
      }
      .progress-text {
        text-align: center;
        color: var(--text-muted);
        font-size: 0.85rem;
        margin-bottom: 20px;
      }

      .quiz-question {
        text-align: center;
        margin-bottom: 24px;
      }
      .quiz-letter {
        font-size: 5rem;
        font-weight: 700;
        margin-bottom: 16px;
      }
      .quiz-prompt {
        color: var(--text-muted);
        font-size: 1.1rem;
      }

      .quiz-options {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 12px;
        margin-bottom: 24px;
      }

      .quiz-option {
        padding: 20px;
        background: var(--card-bg);
        border: 2px solid transparent;
        border-radius: 16px;
        font-family: inherit;
        font-size: 1.1rem;
        color: var(--text);
        cursor: pointer;
        transition: all 0.2s;
      }

      .quiz-option:hover {
        background: var(--card-hover);
        border-color: var(--accent);
      }
      .quiz-option.correct {
        background: rgba(16, 185, 129, 0.2);
        border-color: var(--success);
      }
      .quiz-option.wrong {
        background: rgba(239, 68, 68, 0.2);
        border-color: var(--error);
      }
      .quiz-option:disabled {
        cursor: default;
      }

      .score-display {
        text-align: center;
        padding: 24px;
        background: var(--card-bg);
        border-radius: 16px;
        margin-bottom: 24px;
      }
      .score-number {
        font-size: 3rem;
        font-weight: 700;
        color: var(--accent);
      }
      .score-label {
        color: var(--text-muted);
      }

      .hidden {
        display: none !important;
      }

      .practice-words {
        background: var(--card-bg);
        border-radius: 16px;
        padding: 24px;
        margin-top: 24px;
      }
      .practice-words h3 {
        font-size: 1rem;
        margin-bottom: 16px;
        color: var(--accent);
      }
      .word-list {
        display: flex;
        flex-direction: column;
        gap: 12px;
      }

      .word-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 16px;
        background: rgba(255, 255, 255, 0.03);
        border-radius: 10px;
      }

      .word-cyrillic {
        font-size: 1.3rem;
        font-weight: 600;
        letter-spacing: 1px;
      }
      .word-info {
        text-align: right;
      }
      .word-latin {
        font-size: 0.9rem;
        color: var(--text-muted);
      }
      .word-meaning {
        font-size: 0.85rem;
        color: var(--accent);
      }

      .reference-table {
        background: var(--card-bg);
        border-radius: 16px;
        padding: 20px;
        margin-bottom: 24px;
      }
      .reference-table h3 {
        font-size: 1rem;
        margin-bottom: 16px;
        color: var(--accent);
      }
      .letter-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
        gap: 8px;
      }

      .letter-cell {
        background: rgba(255, 255, 255, 0.03);
        border-radius: 8px;
        padding: 10px;
        text-align: center;
        cursor: pointer;
        transition: all 0.2s;
      }

      .letter-cell:hover {
        background: rgba(255, 255, 255, 0.08);
        transform: scale(1.05);
      }
      .letter-cell .cyrillic {
        font-size: 1.4rem;
        font-weight: 600;
      }
      .letter-cell .sound {
        font-size: 0.75rem;
        color: var(--text-muted);
        margin-top: 4px;
      }

      .vocab-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        flex-wrap: wrap;
        gap: 12px;
      }
      .vocab-header h2 {
        font-size: 1.3rem;
        color: var(--accent);
      }
      .vocab-stats {
        color: var(--text-muted);
        font-size: 0.9rem;
      }

      .category-tabs {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin-bottom: 20px;
        padding-bottom: 8px;
      }

      .category-tab {
        padding: 8px 16px;
        background: var(--card-bg);
        border: none;
        border-radius: 16px;
        color: var(--text-muted);
        font-family: inherit;
        font-size: 0.85rem;
        cursor: pointer;
        transition: all 0.2s;
        white-space: nowrap;
        flex-shrink: 0;
      }

      .category-tab:hover {
        background: var(--card-hover);
      }
      .category-tab.active {
        background: var(--accent);
        color: var(--bg);
        font-weight: 600;
      }

      .vocab-grid {
        display: grid;
        gap: 10px;
      }

      .vocab-card {
        background: var(--card-bg);
        border-radius: 12px;
        padding: 16px;
        display: grid;
        grid-template-columns: 1fr auto;
        align-items: center;
        gap: 12px;
        cursor: pointer;
        transition: all 0.2s;
        border: 1px solid transparent;
      }

      .vocab-card:hover {
        background: var(--card-hover);
        border-color: rgba(245, 158, 11, 0.3);
      }
      .vocab-left {
        display: flex;
        flex-direction: column;
        gap: 4px;
      }
      .vocab-macedonian {
        font-size: 1.4rem;
        font-weight: 600;
      }
      .vocab-latin {
        font-size: 1rem;
        color: var(--text-muted);
      }
      .vocab-answer {
        font-size: 1.1rem;
        color: var(--accent);
        opacity: 0;
        transition: opacity 0.3s;
        text-align: right;
      }
      .vocab-card.revealed .vocab-answer {
        opacity: 1;
      }

      .search-box {
        width: 100%;
        padding: 14px 20px;
        background: var(--card-bg);
        border: 2px solid transparent;
        border-radius: 12px;
        color: var(--text);
        font-family: inherit;
        font-size: 1rem;
        margin-bottom: 20px;
        transition: all 0.2s;
      }

      .search-box:focus {
        outline: none;
        border-color: var(--accent);
      }
      .search-box::placeholder {
        color: var(--text-muted);
      }

      .toggle-row {
        display: flex;
        gap: 8px;
        margin-bottom: 16px;
      }

      .toggle-btn {
        flex: 1;
        padding: 10px;
        background: var(--card-bg);
        border: 2px solid transparent;
        border-radius: 10px;
        color: var(--text-muted);
        font-family: inherit;
        font-size: 0.85rem;
        cursor: pointer;
        transition: all 0.2s;
      }

      .toggle-btn.active {
        border-color: var(--accent);
        color: var(--accent);
      }

      .vocab-quiz-card {
        background: var(--card-bg);
        border-radius: 20px;
        padding: 32px;
        text-align: center;
        margin-bottom: 24px;
      }

      .vocab-quiz-word {
        font-size: 2.5rem;
        font-weight: 700;
        margin-bottom: 8px;
      }
      .vocab-quiz-latin {
        color: var(--text-muted);
        font-size: 1rem;
        margin-bottom: 24px;
      }
      .vocab-quiz-prompt {
        color: var(--text-muted);
        margin-bottom: 20px;
      }

      .vocab-input {
        width: 100%;
        padding: 16px 20px;
        background: rgba(255, 255, 255, 0.05);
        border: 2px solid transparent;
        border-radius: 12px;
        color: var(--text);
        font-family: inherit;
        font-size: 1.1rem;
        text-align: center;
        margin-bottom: 16px;
      }

      .vocab-input:focus {
        outline: none;
        border-color: var(--accent);
      }
      .vocab-input.correct {
        border-color: var(--success);
        background: rgba(16, 185, 129, 0.1);
      }
      .vocab-input.wrong {
        border-color: var(--error);
        background: rgba(239, 68, 68, 0.1);
      }

      .vocab-feedback {
        padding: 12px;
        border-radius: 10px;
        margin-bottom: 16px;
        font-weight: 600;
      }
      .vocab-feedback.correct {
        background: rgba(16, 185, 129, 0.15);
        color: var(--success);
      }
      .vocab-feedback.wrong {
        background: rgba(239, 68, 68, 0.15);
        color: var(--error);
      }

      .info-text {
        color: var(--text-muted);
        font-size: 0.85rem;
        margin-bottom: 16px;
        text-align: center;
      }

      .speak-btn {
        background: var(--accent-soft);
        border: none;
        border-radius: 50%;
        width: 44px;
        height: 44px;
        font-size: 1.3rem;
        cursor: pointer;
        transition: all 0.2s;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .speak-btn:hover {
        background: var(--accent);
        transform: scale(1.1);
      }

      .speak-btn:active {
        transform: scale(0.95);
      }

      .speak-btn.speaking {
        animation: pulse 0.5s ease-in-out infinite;
      }

      @keyframes pulse {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.15);
        }
      }

      .flashcard-speak {
        position: absolute;
        top: 16px;
        right: 16px;
      }

      .vocab-card {
        grid-template-columns: auto 1fr auto;
      }

      .vocab-speak {
        width: 36px;
        height: 36px;
        font-size: 1rem;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <h1>–ú–∞–∫–µ–¥–æ–Ω—Å–∫–∞ –ê–∑–±—É–∫–∞</h1>
        <p class="subtitle">Learn Macedonian Cyrillic step by step</p>
      </header>

      <div class="tabs">
        <button class="tab active" data-view="learn">üìö Learn</button>
        <button class="tab" data-view="flashcards">üé¥ Flashcards</button>
        <button class="tab" data-view="quiz">‚úÖ Quiz</button>
        <button class="tab" data-view="vocab">üìù Vocabulary</button>
        <button class="tab" data-view="reference">üìã Reference</button>
      </div>

      <!-- LEARN VIEW -->
      <div id="learn-view">
        <div class="groups">
          <div class="group-card selected" data-group="1">
            <h3>Group 1</h3>
            <div class="letters">–ê –ï –ö –ú –û –¢</div>
            <div class="count">6 letters ‚Ä¢ Already know these!</div>
          </div>
          <div class="group-card" data-group="2">
            <h3>Group 2</h3>
            <div class="letters">–í –ù –† –° –£ –• –à</div>
            <div class="count">7 letters ‚Ä¢ False friends</div>
          </div>
          <div class="group-card" data-group="3">
            <h3>Group 3</h3>
            <div class="letters">–ë –ì –î –ó –ò –õ –ü –§ –®</div>
            <div class="count">9 letters ‚Ä¢ New but easy</div>
          </div>
          <div class="group-card" data-group="4">
            <h3>Group 4</h3>
            <div class="letters">–ñ –¶ –ß –è –Ö</div>
            <div class="count">5 letters ‚Ä¢ Combo sounds</div>
          </div>
          <div class="group-card" data-group="5">
            <h3>Group 5</h3>
            <div class="letters">–É –å –â –ä</div>
            <div class="count">4 letters ‚Ä¢ Unique to Macedonian</div>
          </div>
        </div>

        <div class="progress-bar">
          <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
        </div>
        <div class="progress-text" id="progress-text">Card 1 of 6</div>

        <div class="flashcard-container">
          <div class="flashcard" id="flashcard">
            <div class="flashcard-face flashcard-front">
              <div class="flashcard-group-badge" id="card-badge">Group 1</div>
              <button
                class="speak-btn flashcard-speak"
                id="card-speak"
                onclick="event.stopPropagation(); speakMacedonian(document.getElementById('card-letter').textContent)"
              >
                üîä
              </button>
              <div class="flashcard-letter" id="card-letter">–ê</div>
              <div class="flashcard-lowercase" id="card-lowercase">–∞</div>
              <div class="flashcard-hint">Tap to reveal sound</div>
            </div>
            <div class="flashcard-face flashcard-back">
              <button
                class="speak-btn flashcard-speak"
                id="card-speak-word"
                onclick="event.stopPropagation(); speakWord(currentGroup, currentCard)"
              >
                üîä
              </button>
              <div class="flashcard-sound" id="card-sound">"a"</div>
              <div class="flashcard-example" id="card-example">
                Like 'a' in 'father'
              </div>
              <div class="flashcard-trick" id="card-trick"></div>
              <div class="flashcard-word-example" id="card-word-example">
                <div class="cyrillic">–ú–ê–ú–ê</div>
                <div class="meaning">mama = mom</div>
              </div>
            </div>
          </div>
        </div>

        <div class="controls">
          <button class="btn btn-secondary" id="prev-btn">‚Üê Previous</button>
          <button class="btn btn-primary" id="next-btn">Next ‚Üí</button>
        </div>

        <div class="practice-words" id="practice-words">
          <h3>üéØ Practice reading these words:</h3>
          <div class="word-list" id="word-list"></div>
        </div>
      </div>

      <!-- FLASHCARDS VIEW -->
      <div id="flashcards-view" class="hidden">
        <div class="vocab-header">
          <h2>üé¥ All 31 Letters</h2>
          <span class="vocab-stats" id="flashcard-counter">1 / 31</span>
        </div>

        <div class="groups" id="fc-groups">
          <div class="group-card selected" data-group="1" data-fc="true">
            <h3>Group 1</h3>
            <div class="letters">–ê –ï –ö –ú –û –¢</div>
            <div class="count">6 letters</div>
          </div>
          <div class="group-card" data-group="2" data-fc="true">
            <h3>Group 2</h3>
            <div class="letters">–í –ù –† –° –£ –• –à</div>
            <div class="count">7 letters</div>
          </div>
          <div class="group-card" data-group="3" data-fc="true">
            <h3>Group 3</h3>
            <div class="letters">–ë –ì –î –ó –ò –õ –ü –§ –®</div>
            <div class="count">9 letters</div>
          </div>
          <div class="group-card" data-group="4" data-fc="true">
            <h3>Group 4</h3>
            <div class="letters">–ñ –¶ –ß –è –Ö</div>
            <div class="count">5 letters</div>
          </div>
          <div class="group-card" data-group="5" data-fc="true">
            <h3>Group 5</h3>
            <div class="letters">–É –å –â –ä</div>
            <div class="count">4 letters</div>
          </div>
          <div class="group-card" data-group="all" data-fc="true">
            <h3>All Groups</h3>
            <div class="letters">–ê ‚Äî –®</div>
            <div class="count">31 letters</div>
          </div>
        </div>

        <div class="toggle-row">
          <button class="toggle-btn active" id="fc-shuffle-off">
            In Order
          </button>
          <button class="toggle-btn" id="fc-shuffle-on">Shuffle</button>
        </div>

        <div class="flashcard-container">
          <div class="flashcard" id="flashcard-all">
            <div class="flashcard-face flashcard-front">
              <div class="flashcard-group-badge" id="fc-badge">Group 1</div>
              <button
                class="speak-btn flashcard-speak"
                onclick="event.stopPropagation(); speakMacedonian(document.getElementById('fc-letter').textContent)"
              >
                üîä
              </button>
              <div class="flashcard-letter" id="fc-letter">–ê</div>
              <div class="flashcard-lowercase" id="fc-lowercase">–∞</div>
              <div class="flashcard-hint">Tap to flip</div>
            </div>
            <div class="flashcard-face flashcard-back">
              <button
                class="speak-btn flashcard-speak"
                id="fc-speak-word"
                onclick="event.stopPropagation(); if (fcFilteredLetters.length > 0 && fcFilteredLetters[fcIndex]) speakMacedonian(fcFilteredLetters[fcIndex].word)"
              >
                üîä
              </button>
              <div class="flashcard-sound" id="fc-sound">"a"</div>
              <div class="flashcard-example" id="fc-example">
                Like 'a' in 'father'
              </div>
              <div class="flashcard-trick" id="fc-trick"></div>
              <div class="flashcard-word-example" id="fc-word-example">
                <div class="cyrillic">–ú–ê–ú–ê</div>
                <div class="meaning">mama = mom</div>
              </div>
            </div>
          </div>
        </div>

        <div class="controls">
          <button class="btn btn-secondary" id="fc-prev-btn">‚Üê Previous</button>
          <button class="btn btn-primary" id="fc-next-btn">Next ‚Üí</button>
        </div>
        <div class="controls">
          <button class="btn btn-secondary btn-small" id="fc-restart-btn">
            üîÑ Restart
          </button>
        </div>
      </div>

      <!-- QUIZ VIEW -->
      <div id="quiz-view" class="hidden">
        <div class="groups">
          <div class="group-card selected" data-group="1" data-quiz="true">
            <h3>Group 1</h3>
            <div class="letters">–ê –ï –ö –ú –û –¢</div>
            <div class="count">Familiar letters</div>
          </div>
          <div class="group-card" data-group="2" data-quiz="true">
            <h3>Group 2</h3>
            <div class="letters">–í –ù –† –° –£ –• –à</div>
            <div class="count">False friends</div>
          </div>
          <div class="group-card" data-group="3" data-quiz="true">
            <h3>Group 3</h3>
            <div class="letters">–ë –ì –î –ó –ò –õ –ü –§ –®</div>
            <div class="count">New letters</div>
          </div>
          <div class="group-card" data-group="4" data-quiz="true">
            <h3>Group 4</h3>
            <div class="letters">–ñ –¶ –ß –è –Ö</div>
            <div class="count">Combo sounds</div>
          </div>
          <div class="group-card" data-group="5" data-quiz="true">
            <h3>Group 5</h3>
            <div class="letters">–É –å –â –ä</div>
            <div class="count">Unique letters</div>
          </div>
          <div class="group-card" data-group="all" data-quiz="true">
            <h3>All Groups</h3>
            <div class="letters">–ê ‚Äî –®</div>
            <div class="count">All 31 letters</div>
          </div>
        </div>

        <div class="score-display">
          <div class="score-number" id="score">0/0</div>
          <div class="score-label">Correct answers</div>
        </div>

        <div class="quiz-question">
          <div class="quiz-letter" id="quiz-letter">–ê</div>
          <div class="quiz-prompt">What sound does this letter make?</div>
        </div>

        <div class="quiz-options" id="quiz-options"></div>

        <div class="controls hidden" id="quiz-controls">
          <button class="btn btn-primary" id="next-quiz-btn">
            Next Question ‚Üí
          </button>
        </div>

        <div id="quiz-summary" class="hidden">
          <div class="score-display">
            <div class="score-number" id="summary-score">0/0</div>
            <div class="score-label">Final Score</div>
          </div>
          <div id="summary-content"></div>
          <div class="controls">
            <button class="btn btn-secondary" id="restart-quiz-btn">
              üîÑ Restart Quiz
            </button>
            <button class="btn btn-primary" id="new-group-btn">
              New Group ‚Üí
            </button>
          </div>
        </div>
      </div>

      <!-- VOCABULARY VIEW -->
      <div id="vocab-view" class="hidden">
        <div class="vocab-header">
          <h2>üìù Essential Vocabulary</h2>
          <span class="vocab-stats" id="vocab-count">100+ words</span>
        </div>

        <input
          type="text"
          class="search-box"
          id="vocab-search"
          placeholder="üîç Search words in English or Macedonian..."
        />

        <div class="category-tabs" id="category-tabs">
          <button class="category-tab active" data-category="all">All</button>
          <button class="category-tab" data-category="animals">
            üêæ Animals
          </button>
          <button class="category-tab" data-category="food">üçé Food</button>
          <button class="category-tab" data-category="drinks">ü•§ Drinks</button>
          <button class="category-tab" data-category="family">üë®‚Äçüë©‚Äçüëß Family</button>
          <button class="category-tab" data-category="body">ü¶∂ Body</button>
          <button class="category-tab" data-category="home">üè† Home</button>
          <button class="category-tab" data-category="nature">üå≥ Nature</button>
          <button class="category-tab" data-category="colors">üé® Colors</button>
          <button class="category-tab" data-category="numbers">
            üî¢ Numbers
          </button>
          <button class="category-tab" data-category="phrases">
            üó£Ô∏è Phrases
          </button>
          <button class="category-tab" data-category="common">üí¨ Common</button>
        </div>

        <div class="toggle-row">
          <button class="toggle-btn active" id="vocab-browse">Browse</button>
          <button class="toggle-btn" id="vocab-quiz-mode">Quiz Mode</button>
        </div>

        <div id="vocab-browse-container">
          <p class="info-text">Tap a word to reveal its meaning</p>
          <div class="vocab-grid" id="vocab-grid"></div>
        </div>

        <div id="vocab-quiz-container" class="hidden">
          <div class="score-display">
            <div class="score-number" id="vocab-score">0/0</div>
            <div class="score-label">Correct answers</div>
          </div>

          <div class="vocab-quiz-card">
            <button
              class="speak-btn"
              onclick="speakMacedonian(vocabQuizWords[vocabQuizIndex].mk)"
              style="margin: 0 auto 16px"
            >
              üîä
            </button>
            <div class="vocab-quiz-word" id="vq-word">–ú–ê–ß–ö–ê</div>
            <div class="vocab-quiz-latin" id="vq-latin">maƒçka</div>
            <div class="vocab-quiz-prompt">What does this word mean?</div>
            <input
              type="text"
              class="vocab-input"
              id="vq-input"
              placeholder="Type the English meaning..."
            />
            <div class="vocab-feedback hidden" id="vq-feedback"></div>
          </div>

          <div class="controls">
            <button class="btn btn-secondary" id="vq-show-btn">
              Show Answer
            </button>
            <button class="btn btn-primary" id="vq-next-btn">
              Next Word ‚Üí
            </button>
          </div>
        </div>
      </div>

      <!-- REFERENCE VIEW -->
      <div id="reference-view" class="hidden">
        <div class="reference-table">
          <h3>Group 1: Familiar (look & sound like English)</h3>
          <div class="letter-grid" id="ref-group1"></div>
        </div>
        <div class="reference-table">
          <h3>Group 2: False Friends (look familiar, different sound)</h3>
          <div class="letter-grid" id="ref-group2"></div>
        </div>
        <div class="reference-table">
          <h3>Group 3: New but Easy</h3>
          <div class="letter-grid" id="ref-group3"></div>
        </div>
        <div class="reference-table">
          <h3>Group 4: Combo Sounds</h3>
          <div class="letter-grid" id="ref-group4"></div>
        </div>
        <div class="reference-table">
          <h3>Group 5: Unique to Macedonian</h3>
          <div class="letter-grid" id="ref-group5"></div>
        </div>
      </div>
    </div>

    <script>
      const letterGroups = {
        1: [
          {
            letter: "–ê",
            lower: "–∞",
            sound: "a",
            example: "Like 'a' in 'father'",
            trick: "Same as English A",
            word: "–ú–ê–ú–ê",
            wordLatin: "mama",
            wordMeaning: "mom",
          },
          {
            letter: "–ï",
            lower: "–µ",
            sound: "e",
            example: "Like 'e' in 'bet'",
            trick: "Same as English E",
            word: "–î–ï–ù",
            wordLatin: "den",
            wordMeaning: "day",
          },
          {
            letter: "–ö",
            lower: "–∫",
            sound: "k",
            example: "Like 'k' in 'kite'",
            trick: "Same as English K",
            word: "–ö–ù–ò–ì–ê",
            wordLatin: "kniga",
            wordMeaning: "book",
          },
          {
            letter: "–ú",
            lower: "–º",
            sound: "m",
            example: "Like 'm' in 'mom'",
            trick: "Same as English M",
            word: "–ú–û–†–ï",
            wordLatin: "more",
            wordMeaning: "sea",
          },
          {
            letter: "–û",
            lower: "–æ",
            sound: "o",
            example: "Like 'o' in 'pot'",
            trick: "Same as English O",
            word: "–û–ö–û",
            wordLatin: "oko",
            wordMeaning: "eye",
          },
          {
            letter: "–¢",
            lower: "—Ç",
            sound: "t",
            example: "Like 't' in 'top'",
            trick: "Same as English T",
            word: "–¢–ê–¢–û",
            wordLatin: "tato",
            wordMeaning: "dad",
          },
        ],
        2: [
          {
            letter: "–í",
            lower: "–≤",
            sound: "v",
            example: "Like 'v' in 'vet'",
            trick: "‚ö†Ô∏è Looks like B = sounds like V!",
            word: "–í–û–î–ê",
            wordLatin: "voda",
            wordMeaning: "water",
          },
          {
            letter: "–ù",
            lower: "–Ω",
            sound: "n",
            example: "Like 'n' in 'no'",
            trick: "‚ö†Ô∏è Looks like H = sounds like N!",
            word: "–ù–û–°",
            wordLatin: "nos",
            wordMeaning: "nose",
          },
          {
            letter: "–†",
            lower: "—Ä",
            sound: "r",
            example: "Rolled 'r' (trilled)",
            trick: "‚ö†Ô∏è Looks like P = sounds like R!",
            word: "–†–ò–ë–ê",
            wordLatin: "riba",
            wordMeaning: "fish",
          },
          {
            letter: "–°",
            lower: "—Å",
            sound: "s",
            example: "Like 's' in 'sun'",
            trick: "‚ö†Ô∏è Looks like C = sounds like S!",
            word: "–°–û–ù–¶–ï",
            wordLatin: "sonce",
            wordMeaning: "sun",
          },
          {
            letter: "–£",
            lower: "—É",
            sound: "oo",
            example: "Like 'oo' in 'food'",
            trick: "‚ö†Ô∏è Looks like Y = sounds like OO!",
            word: "–£–í–û",
            wordLatin: "uvo",
            wordMeaning: "ear",
          },
          {
            letter: "–•",
            lower: "—Ö",
            sound: "h",
            example: "Like 'ch' in Scottish 'loch'",
            trick: "‚ö†Ô∏è Looks like X = sounds like H!",
            word: "–•–†–ê–ù–ê",
            wordLatin: "hrana",
            wordMeaning: "food",
          },
          {
            letter: "–à",
            lower: "—ò",
            sound: "y",
            example: "Like 'y' in 'yes'",
            trick: "‚ö†Ô∏è Looks like J = sounds like Y!",
            word: "–à–ê–ë–û–õ–ö–û",
            wordLatin: "jabolko",
            wordMeaning: "apple",
          },
        ],
        3: [
          {
            letter: "–ë",
            lower: "–±",
            sound: "b",
            example: "Like 'b' in 'bat'",
            trick: "Looks like a 6",
            word: "–ë–†–ê–¢",
            wordLatin: "brat",
            wordMeaning: "brother",
          },
          {
            letter: "–ì",
            lower: "–≥",
            sound: "g",
            example: "Like 'g' in 'go'",
            trick: "Looks like upside-down L",
            word: "–ì–õ–ê–í–ê",
            wordLatin: "glava",
            wordMeaning: "head",
          },
          {
            letter: "–î",
            lower: "–¥",
            sound: "d",
            example: "Like 'd' in 'dog'",
            trick: "Looks like a little house",
            word: "–î–û–ú",
            wordLatin: "dom",
            wordMeaning: "home",
          },
          {
            letter: "–ó",
            lower: "–∑",
            sound: "z",
            example: "Like 'z' in 'zoo'",
            trick: "Looks like a 3",
            word: "–ó–ï–ú–à–ê",
            wordLatin: "zemja",
            wordMeaning: "earth",
          },
          {
            letter: "–ò",
            lower: "–∏",
            sound: "ee",
            example: "Like 'ee' in 'see'",
            trick: "Backwards N = ee",
            word: "–ò–ú–ï",
            wordLatin: "ime",
            wordMeaning: "name",
          },
          {
            letter: "–õ",
            lower: "–ª",
            sound: "l",
            example: "Like 'l' in 'lamp'",
            trick: "Looks like a tent /\\",
            word: "–õ–ò–°–¢",
            wordLatin: "list",
            wordMeaning: "leaf",
          },
          {
            letter: "–ü",
            lower: "–ø",
            sound: "p",
            example: "Like 'p' in 'pen'",
            trick: "Looks like a doorway",
            word: "–ü–ê–¢",
            wordLatin: "pat",
            wordMeaning: "road",
          },
          {
            letter: "–§",
            lower: "—Ñ",
            sound: "f",
            example: "Like 'f' in 'fan'",
            trick: "Person with arms out",
            word: "–§–ò–õ–ú",
            wordLatin: "film",
            wordMeaning: "film",
          },
          {
            letter: "–®",
            lower: "—à",
            sound: "sh",
            example: "Like 'sh' in 'ship'",
            trick: "Comb with 3 teeth = sh",
            word: "–®–ö–û–õ–ê",
            wordLatin: "≈°kola",
            wordMeaning: "school",
          },
        ],
        4: [
          {
            letter: "–ñ",
            lower: "–∂",
            sound: "zh",
            example: "Like 's' in 'measure'",
            trick: "Butterfly shape = zh",
            word: "–ñ–ï–ù–ê",
            wordLatin: "≈æena",
            wordMeaning: "woman",
          },
          {
            letter: "–¶",
            lower: "—Ü",
            sound: "ts",
            example: "Like 'ts' in 'cats'",
            trick: "Makes the 'ts' combo",
            word: "–¶–í–ï–¢",
            wordLatin: "cvet",
            wordMeaning: "flower",
          },
          {
            letter: "–ß",
            lower: "—á",
            sound: "ch",
            example: "Like 'ch' in 'church'",
            trick: "Makes the 'ch' combo",
            word: "–ß–ê–à",
            wordLatin: "ƒçaj",
            wordMeaning: "tea",
          },
          {
            letter: "–è",
            lower: "—ü",
            sound: "j",
            example: "Like 'j' in 'jungle'",
            trick: "Makes the 'dj' combo",
            word: "–è–ï–ë",
            wordLatin: "d≈æeb",
            wordMeaning: "pocket",
          },
          {
            letter: "–Ö",
            lower: "—ï",
            sound: "dz",
            example: "Like 'ds' in 'heads'",
            trick: "‚ö†Ô∏è Looks like S = sounds DZ!",
            word: "–Ö–í–ï–ó–î–ê",
            wordLatin: "dzvezda",
            wordMeaning: "star",
          },
        ],
        5: [
          {
            letter: "–É",
            lower: "—ì",
            sound: "gy",
            example: "Soft 'g' + 'y' blended",
            trick: "–ì + accent = soft gy",
            word: "–É–ê–í–û–õ",
            wordLatin: "gjavol",
            wordMeaning: "devil",
          },
          {
            letter: "–å",
            lower: "—ú",
            sound: "ky",
            example: "Like 'c' in 'cute'",
            trick: "–ö + accent = soft ky",
            word: "–ö–£–å–ê",
            wordLatin: "ku·∏±a",
            wordMeaning: "house",
          },
          {
            letter: "–â",
            lower: "—ô",
            sound: "ly",
            example: "Like 'lli' in 'million'",
            trick: "–õ made soft = ly",
            word: "–â–£–ë–û–í",
            wordLatin: "ljubov",
            wordMeaning: "love",
          },
          {
            letter: "–ä",
            lower: "—ö",
            sound: "ny",
            example: "Like 'ni' in 'onion'",
            trick: "–ù made soft = ny",
            word: "–ö–û–ä",
            wordLatin: "konj",
            wordMeaning: "horse",
          },
        ],
      };

      const practiceWords = {
        1: [
          { cyrillic: "–ú–ê–ú–ê", latin: "mama", meaning: "mom" },
          { cyrillic: "–¢–ê–¢–ê", latin: "tata", meaning: "dad" },
          { cyrillic: "–û–ö–û", latin: "oko", meaning: "eye" },
          { cyrillic: "–ö–û–¢", latin: "kot", meaning: "tomcat" },
        ],
        2: [
          { cyrillic: "–í–û–î–ê", latin: "voda", meaning: "water" },
          { cyrillic: "–ù–û–°", latin: "nos", meaning: "nose" },
          { cyrillic: "–°–û–ù", latin: "son", meaning: "dream" },
          { cyrillic: "–£–í–û", latin: "uvo", meaning: "ear" },
        ],
        3: [
          { cyrillic: "–î–û–ú", latin: "dom", meaning: "home" },
          { cyrillic: "–ë–†–ê–¢", latin: "brat", meaning: "brother" },
          { cyrillic: "–ì–õ–ê–í–ê", latin: "glava", meaning: "head" },
          { cyrillic: "–§–ò–õ–ú", latin: "film", meaning: "film" },
        ],
        4: [
          { cyrillic: "–ñ–ï–ù–ê", latin: "≈æena", meaning: "woman" },
          { cyrillic: "–¶–í–ï–¢", latin: "cvet", meaning: "flower" },
          { cyrillic: "–ß–ê–à", latin: "ƒçaj", meaning: "tea" },
          { cyrillic: "–Ö–í–ï–ó–î–ê", latin: "dzvezda", meaning: "star" },
        ],
        5: [
          { cyrillic: "–ö–£–å–ê", latin: "ku·∏±a", meaning: "house" },
          { cyrillic: "–â–£–ë–û–í", latin: "ljubov", meaning: "love" },
          { cyrillic: "–ö–û–ä", latin: "konj", meaning: "horse" },
          { cyrillic: "–É–ê–í–û–õ", latin: "gjavol", meaning: "devil" },
        ],
      };

      const vocabulary = {
        animals: [
          { mk: "–ú–ê–ß–ö–ê", latin: "maƒçka", en: "cat" },
          { mk: "–ö–£–ß–ï", latin: "kuƒçe", en: "dog" },
          { mk: "–ü–¢–ò–¶–ê", latin: "ptica", en: "bird" },
          { mk: "–†–ò–ë–ê", latin: "riba", en: "fish" },
          { mk: "–ö–û–ä", latin: "konj", en: "horse" },
          { mk: "–ö–†–ê–í–ê", latin: "krava", en: "cow" },
          { mk: "–°–í–ò–ä–ê", latin: "svinja", en: "pig" },
          { mk: "–û–í–¶–ê", latin: "ovca", en: "sheep" },
          { mk: "–ö–û–ó–ê", latin: "koza", en: "goat" },
          { mk: "–ü–ò–õ–ï", latin: "pile", en: "chicken" },
          { mk: "–ó–ê–à–ê–ö", latin: "zajak", en: "rabbit" },
          { mk: "–ú–ï–ß–ö–ê", latin: "meƒçka", en: "bear" },
          { mk: "–í–û–õ–ö", latin: "volk", en: "wolf" },
          { mk: "–õ–ò–°–ò–¶–ê", latin: "lisica", en: "fox" },
          { mk: "–°–õ–û–ù", latin: "slon", en: "elephant" },
        ],
        food: [
          { mk: "–õ–ï–ë", latin: "leb", en: "bread" },
          { mk: "–°–ò–†–ï–ä–ï", latin: "sirenje", en: "cheese" },
          { mk: "–à–ê–à–¶–ï", latin: "jajce", en: "egg" },
          { mk: "–ú–ï–°–û", latin: "meso", en: "meat" },
          { mk: "–û–†–ò–ó", latin: "oriz", en: "rice" },
          { mk: "–à–ê–ë–û–õ–ö–û", latin: "jabolko", en: "apple" },
          { mk: "–ë–ê–ù–ê–ù–ê", latin: "banana", en: "banana" },
          { mk: "–ü–û–†–¢–û–ö–ê–õ", latin: "portokal", en: "orange" },
          { mk: "–î–û–ú–ê–¢", latin: "domat", en: "tomato" },
          { mk: "–ö–†–ê–°–¢–ê–í–ò–¶–ê", latin: "krastavica", en: "cucumber" },
          { mk: "–ú–û–†–ö–û–í", latin: "morkov", en: "carrot" },
          { mk: "–ö–û–ú–ü–ò–†", latin: "kompir", en: "potato" },
          { mk: "–ö–†–û–ú–ò–î", latin: "kromid", en: "onion" },
          { mk: "–®–ï–å–ï–†", latin: "≈°e·∏±er", en: "sugar" },
          { mk: "–°–û–õ", latin: "sol", en: "salt" },
        ],
        drinks: [
          { mk: "–í–û–î–ê", latin: "voda", en: "water" },
          { mk: "–ú–õ–ï–ö–û", latin: "mleko", en: "milk" },
          { mk: "–ö–ê–§–ï", latin: "kafe", en: "coffee" },
          { mk: "–ß–ê–à", latin: "ƒçaj", en: "tea" },
          { mk: "–°–û–ö", latin: "sok", en: "juice" },
          { mk: "–ü–ò–í–û", latin: "pivo", en: "beer" },
          { mk: "–í–ò–ù–û", latin: "vino", en: "wine" },
          { mk: "–†–ê–ö–ò–à–ê", latin: "rakija", en: "brandy" },
        ],
        family: [
          { mk: "–ú–ê–à–ö–ê", latin: "majka", en: "mother" },
          { mk: "–¢–ê–¢–ö–û", latin: "tatko", en: "father" },
          { mk: "–ë–†–ê–¢", latin: "brat", en: "brother" },
          { mk: "–°–ï–°–¢–†–ê", latin: "sestra", en: "sister" },
          { mk: "–°–ò–ù", latin: "sin", en: "son" },
          { mk: "–å–ï–†–ö–ê", latin: "·∏±erka", en: "daughter" },
          { mk: "–ë–ê–ë–ê", latin: "baba", en: "grandmother" },
          { mk: "–î–ï–î–û", latin: "dedo", en: "grandfather" },
          { mk: "–í–£–à–ö–û", latin: "vujko", en: "uncle" },
          { mk: "–¢–ï–¢–ö–ê", latin: "tetka", en: "aunt" },
          { mk: "–î–ï–¢–ï", latin: "dete", en: "child" },
          { mk: "–°–ï–ú–ï–à–°–¢–í–û", latin: "semejstvo", en: "family" },
        ],
        body: [
          { mk: "–ì–õ–ê–í–ê", latin: "glava", en: "head" },
          { mk: "–û–ö–û", latin: "oko", en: "eye" },
          { mk: "–£–í–û", latin: "uvo", en: "ear" },
          { mk: "–ù–û–°", latin: "nos", en: "nose" },
          { mk: "–£–°–¢–ê", latin: "usta", en: "mouth" },
          { mk: "–ó–ê–ë–ò", latin: "zabi", en: "teeth" },
          { mk: "–à–ê–ó–ò–ö", latin: "jazik", en: "tongue" },
          { mk: "–†–ê–ö–ê", latin: "raka", en: "hand" },
          { mk: "–ù–û–ì–ê", latin: "noga", en: "leg" },
          { mk: "–ü–†–°–¢", latin: "prst", en: "finger" },
          { mk: "–°–†–¶–ï", latin: "srce", en: "heart" },
          { mk: "–ö–û–°–ê", latin: "kosa", en: "hair" },
          { mk: "–õ–ò–¶–ï", latin: "lice", en: "face" },
          { mk: "–°–¢–û–ú–ê–ö", latin: "stomak", en: "stomach" },
        ],
        home: [
          { mk: "–ö–£–å–ê", latin: "ku·∏±a", en: "house" },
          { mk: "–í–†–ê–¢–ê", latin: "vrata", en: "door" },
          { mk: "–ü–†–û–ó–û–†–ï–¶", latin: "prozorec", en: "window" },
          { mk: "–°–û–ë–ê", latin: "soba", en: "room" },
          { mk: "–ö–£–à–ù–ê", latin: "kujna", en: "kitchen" },
          { mk: "–ë–ê–ä–ê", latin: "banja", en: "bathroom" },
          { mk: "–ú–ê–°–ê", latin: "masa", en: "table" },
          { mk: "–°–¢–û–õ", latin: "stol", en: "chair" },
          { mk: "–ö–†–ï–í–ï–¢", latin: "krevet", en: "bed" },
          { mk: "–ü–û–î", latin: "pod", en: "floor" },
          { mk: "–ö–õ–£–ß", latin: "kluƒç", en: "key" },
          { mk: "–¢–ï–ü–ò–•", latin: "tepih", en: "carpet" },
        ],
        nature: [
          { mk: "–°–û–ù–¶–ï", latin: "sonce", en: "sun" },
          { mk: "–ú–ï–°–ï–ß–ò–ù–ê", latin: "meseƒçina", en: "moon" },
          { mk: "–Ö–í–ï–ó–î–ê", latin: "dzvezda", en: "star" },
          { mk: "–ù–ï–ë–û", latin: "nebo", en: "sky" },
          { mk: "–û–ë–õ–ê–ö", latin: "oblak", en: "cloud" },
          { mk: "–î–û–ñ–î", latin: "do≈æd", en: "rain" },
          { mk: "–°–ù–ï–ì", latin: "sneg", en: "snow" },
          { mk: "–í–ï–¢–ï–†", latin: "veter", en: "wind" },
          { mk: "–†–ï–ö–ê", latin: "reka", en: "river" },
          { mk: "–ú–û–†–ï", latin: "more", en: "sea" },
          { mk: "–ï–ó–ï–†–û", latin: "ezero", en: "lake" },
          { mk: "–ü–õ–ê–ù–ò–ù–ê", latin: "planina", en: "mountain" },
          { mk: "–î–†–í–û", latin: "drvo", en: "tree" },
          { mk: "–¶–í–ï–¢", latin: "cvet", en: "flower" },
          { mk: "–¢–†–ï–í–ê", latin: "treva", en: "grass" },
        ],
        colors: [
          { mk: "–¶–†–í–ï–ù–ê", latin: "crvena", en: "red" },
          { mk: "–°–ò–ù–ê", latin: "sina", en: "blue" },
          { mk: "–ó–ï–õ–ï–ù–ê", latin: "zelena", en: "green" },
          { mk: "–ñ–û–õ–¢–ê", latin: "≈æolta", en: "yellow" },
          { mk: "–ë–ï–õ–ê", latin: "bela", en: "white" },
          { mk: "–¶–†–ù–ê", latin: "crna", en: "black" },
          { mk: "–ü–û–†–¢–û–ö–ê–õ–û–í–ê", latin: "portokalova", en: "orange" },
          { mk: "–†–û–ó–û–í–ê", latin: "rozova", en: "pink" },
          { mk: "–ö–ê–§–ï–ê–í–ê", latin: "kafeava", en: "brown" },
          { mk: "–°–ò–í–ê", latin: "siva", en: "gray" },
        ],
        numbers: [
          { mk: "–ï–î–ï–ù", latin: "eden", en: "one" },
          { mk: "–î–í–ê", latin: "dva", en: "two" },
          { mk: "–¢–†–ò", latin: "tri", en: "three" },
          { mk: "–ß–ï–¢–ò–†–ò", latin: "ƒçetiri", en: "four" },
          { mk: "–ü–ï–¢", latin: "pet", en: "five" },
          { mk: "–®–ï–°–¢", latin: "≈°est", en: "six" },
          { mk: "–°–ï–î–£–ú", latin: "sedum", en: "seven" },
          { mk: "–û–°–£–ú", latin: "osum", en: "eight" },
          { mk: "–î–ï–í–ï–¢", latin: "devet", en: "nine" },
          { mk: "–î–ï–°–ï–¢", latin: "deset", en: "ten" },
        ],
        common: [
          { mk: "–î–ê", latin: "da", en: "yes" },
          { mk: "–ù–ï", latin: "ne", en: "no" },
          { mk: "–î–û–ë–†–û", latin: "dobro", en: "good" },
          { mk: "–õ–û–®–û", latin: "lo≈°o", en: "bad" },
          { mk: "–ì–û–õ–ï–ú–û", latin: "golemo", en: "big" },
          { mk: "–ú–ê–õ–û", latin: "malo", en: "small" },
          { mk: "–ù–û–í–û", latin: "novo", en: "new" },
          { mk: "–°–¢–ê–†–û", latin: "staro", en: "old" },
          { mk: "–¢–û–ü–õ–û", latin: "toplo", en: "warm" },
          { mk: "–õ–ê–î–ù–û", latin: "ladno", en: "cold" },
          { mk: "–î–ï–ù–ï–°", latin: "denes", en: "today" },
          { mk: "–£–¢–†–ï", latin: "utre", en: "tomorrow" },
          { mk: "–í–ß–ï–†–ê", latin: "vƒçera", en: "yesterday" },
          { mk: "–°–ï–ì–ê", latin: "sega", en: "now" },
          { mk: "–¢–£–ö–ê", latin: "tuka", en: "here" },
          { mk: "–¢–ê–ú–£", latin: "tamu", en: "there" },
          { mk: "–ë–õ–ê–ì–û–î–ê–†–ê–ú", latin: "blagodaram", en: "thank you" },
          { mk: "–ú–û–õ–ê–ú", latin: "molam", en: "please" },
          { mk: "–ó–î–†–ê–í–û", latin: "zdravo", en: "hello" },
          { mk: "–î–û–í–ò–î–£–í–ê–ä–ï", latin: "doviduvanje", en: "goodbye" },
        ],
        phrases: [
          { mk: "–î–û–ë–†–û –£–¢–†–û", latin: "dobro utro", en: "good morning" },
          { mk: "–î–û–ë–ê–† –î–ï–ù", latin: "dobar den", en: "good afternoon" },
          { mk: "–î–û–ë–†–ê –í–ï–ß–ï–†", latin: "dobra veƒçer", en: "good evening" },
          { mk: "–î–û–ë–†–ê –ù–û–å", latin: "dobra no·∏±", en: "good night" },
          { mk: "–ö–ê–ö–û –°–ò?", latin: "kako si?", en: "how are you?" },
          { mk: "–î–û–ë–†–û –°–£–ú", latin: "dobro sum", en: "I am good" },
          { mk: "–ê –¢–ò?", latin: "a ti?", en: "and you?" },
          { mk: "–à–ê–° –°–£–ú", latin: "jas sum", en: "I am" },
          { mk: "–ú–û–ï–¢–û –ò–ú–ï –ï", latin: "moeto ime e", en: "my name is" },
          {
            mk: "–ö–ê–ö–û –°–ï –í–ò–ö–ê–®?",
            latin: "kako se vika≈°?",
            en: "what is your name?",
          },
          { mk: "–ú–ò–õ–û –ú–ò –ï", latin: "milo mi e", en: "nice to meet you" },
          { mk: "–ò–ó–í–ò–ù–ò", latin: "izvini", en: "sorry / excuse me" },
          { mk: "–ù–ï–ú–ê –ü–†–û–ë–õ–ï–ú", latin: "nema problem", en: "no problem" },
          { mk: "–î–ê, –ú–û–õ–ê–ú", latin: "da, molam", en: "yes, please" },
          {
            mk: "–ù–ï, –ë–õ–ê–ì–û–î–ê–†–ê–ú",
            latin: "ne, blagodaram",
            en: "no, thank you",
          },
          { mk: "–ù–ï –†–ê–ó–ë–ò–†–ê–ú", latin: "ne razbiram", en: "I don't understand" },
          {
            mk: "–ó–ë–û–†–£–í–ê–® –ê–ù–ì–õ–ò–°–ö–ò?",
            latin: "zborava≈° angliski?",
            en: "do you speak English?",
          },
          {
            mk: "–ú–ê–õ–û –ó–ë–û–†–£–í–ê–ú",
            latin: "malo zboruvam",
            en: "I speak a little",
          },
          { mk: "–ü–û–í–¢–û–†–ò –ú–û–õ–ê–ú", latin: "povtori molam", en: "repeat please" },
          { mk: "–ü–û–õ–ï–ö–ê –ú–û–õ–ê–ú", latin: "poleka molam", en: "slowly please" },
          {
            mk: "–ö–û–õ–ö–£ –ß–ò–ù–ò?",
            latin: "kolku ƒçini?",
            en: "how much does it cost?",
          },
          { mk: "–ö–ê–î–ï –ï...?", latin: "kade e...?", en: "where is...?" },
          { mk: "–®–¢–û –ï –û–í–ê?", latin: "≈°to e ova?", en: "what is this?" },
          { mk: "–°–ê–ö–ê–ú", latin: "sakam", en: "I want / I love" },
          { mk: "–ù–ï –°–ê–ö–ê–ú", latin: "ne sakam", en: "I don't want" },
          { mk: "–ì–õ–ê–î–ï–ù –°–£–ú", latin: "gladen sum", en: "I am hungry (male)" },
          { mk: "–ì–õ–ê–î–ù–ê –°–£–ú", latin: "gladna sum", en: "I am hungry (female)" },
          { mk: "–ñ–ï–î–ï–ù –°–£–ú", latin: "≈æeden sum", en: "I am thirsty (male)" },
          { mk: "–ñ–ï–î–ù–ê –°–£–ú", latin: "≈æedna sum", en: "I am thirsty (female)" },
          { mk: "–£–ú–û–†–ï–ù –°–£–ú", latin: "umoren sum", en: "I am tired (male)" },
          { mk: "–£–ú–û–†–ù–ê –°–£–ú", latin: "umorna sum", en: "I am tired (female)" },
          { mk: "–ü–û–ú–û–®!", latin: "pomo≈°!", en: "help!" },
          {
            mk: "–°–†–ï–å–ï–ù –†–û–î–ï–ù–î–ï–ù",
            latin: "sre·∏±en rodenden",
            en: "happy birthday",
          },
          {
            mk: "–°–†–ï–å–ù–ê –ù–û–í–ê –ì–û–î–ò–ù–ê",
            latin: "sre·∏±na nova godina",
            en: "happy new year",
          },
          { mk: "–ü–†–ò–à–ê–¢–ù–û", latin: "prijatno", en: "enjoy your meal" },
          { mk: "–ù–ê –ó–î–†–ê–í–à–ï", latin: "na zdravje", en: "cheers / bless you" },
        ],
      };

      let currentGroup = 1,
        currentCard = 0,
        quizGroup = 1,
        quizIndex = 0,
        correctAnswers = 0,
        totalAnswers = 0,
        quizLetters = [],
        incorrectLetters = [],
        quizAnsweredLetters = [];
      let allLetters = [],
        fcIndex = 0,
        fcShuffled = false,
        fcSelectedGroup = "all",
        fcFilteredLetters = [];
      let currentCategory = "all",
        vocabQuizWords = [],
        vocabQuizIndex = 0,
        vocabCorrect = 0,
        vocabTotal = 0;

      const groupColors = {
        1: "#3b82f6",
        2: "#f59e0b",
        3: "#10b981",
        4: "#8b5cf6",
        5: "#ef4444",
      };

      // Text-to-speech function
      function speakMacedonian(text) {
        if ("speechSynthesis" in window) {
          // Cancel any ongoing speech
          window.speechSynthesis.cancel();

          const utterance = new SpeechSynthesisUtterance(text);

          // Try to find a Macedonian, Serbian, or Croatian voice (similar pronunciation)
          const voices = window.speechSynthesis.getVoices();
          const preferredLangs = ["mk", "sr", "hr", "bs", "sl", "bg", "ru"];

          let selectedVoice = null;
          for (const lang of preferredLangs) {
            selectedVoice = voices.find((v) =>
              v.lang.toLowerCase().startsWith(lang)
            );
            if (selectedVoice) break;
          }

          if (selectedVoice) {
            utterance.voice = selectedVoice;
          }

          utterance.rate = 0.8; // Slightly slower for learning
          utterance.pitch = 1;

          window.speechSynthesis.speak(utterance);
        } else {
          alert("Sorry, your browser does not support text-to-speech.");
        }
      }

      // Speak word from flashcard
      function speakWord(group, cardIndex) {
        const word = letterGroups[group][cardIndex].word;
        speakMacedonian(word);
      }

      // Load voices (some browsers load them async)
      if ("speechSynthesis" in window) {
        window.speechSynthesis.onvoiceschanged = () => {
          window.speechSynthesis.getVoices();
        };
      }

      function initAllLetters() {
        allLetters = [];
        for (let g = 1; g <= 5; g++)
          letterGroups[g].forEach((l) => allLetters.push({ ...l, group: g }));
      }
      initAllLetters();

      function getFilteredFlashcardLetters() {
        if (fcSelectedGroup === "all") {
          return [...allLetters];
        } else {
          const groupNum = parseInt(fcSelectedGroup);
          return letterGroups[groupNum].map((l) => ({ ...l, group: groupNum }));
        }
      }

      function updateFlashcardFiltered() {
        fcFilteredLetters = getFilteredFlashcardLetters();
        if (fcShuffled) {
          fcFilteredLetters.sort(() => Math.random() - 0.5);
        }
        if (fcIndex >= fcFilteredLetters.length) {
          fcIndex = 0;
        }
      }

      // View switching
      document.querySelectorAll(".tab").forEach((tab) => {
        tab.addEventListener("click", () => {
          document
            .querySelectorAll(".tab")
            .forEach((t) => t.classList.remove("active"));
          tab.classList.add("active");
          const view = tab.dataset.view;
          ["learn", "flashcards", "quiz", "vocab", "reference"].forEach((v) => {
            document
              .getElementById(v + "-view")
              .classList.toggle("hidden", v !== view);
          });
          if (view === "reference") renderReference();
          if (view === "flashcards") {
            updateFlashcardFiltered();
            updateFlashcardAll();
          }
          if (view === "vocab") renderVocab();
        });
      });

      // Learn view group selection
      document
        .querySelectorAll(".group-card:not([data-quiz])")
        .forEach((card) => {
          card.addEventListener("click", () => {
            document
              .querySelectorAll(".group-card:not([data-quiz])")
              .forEach((c) => c.classList.remove("selected"));
            card.classList.add("selected");
            currentGroup = parseInt(card.dataset.group);
            currentCard = 0;
            document.getElementById("flashcard").classList.remove("flipped");
            updateFlashcard();
            updatePracticeWords();
          });
        });

      // Quiz group selection
      document.querySelectorAll(".group-card[data-quiz]").forEach((card) => {
        card.addEventListener("click", () => {
          document
            .querySelectorAll(".group-card[data-quiz]")
            .forEach((c) => c.classList.remove("selected"));
          card.classList.add("selected");
          quizGroup = card.dataset.group;
          resetQuiz();
        });
      });

      // Flashcard group selection
      document.querySelectorAll(".group-card[data-fc]").forEach((card) => {
        card.addEventListener("click", () => {
          document
            .querySelectorAll(".group-card[data-fc]")
            .forEach((c) => c.classList.remove("selected"));
          card.classList.add("selected");
          fcSelectedGroup = card.dataset.group;
          fcIndex = 0;
          updateFlashcardFiltered();
          document.getElementById("flashcard-all").classList.remove("flipped");
          updateFlashcardAll();
        });
      });

      document
        .getElementById("flashcard")
        .addEventListener("click", () =>
          document.getElementById("flashcard").classList.toggle("flipped")
        );
      document
        .getElementById("flashcard-all")
        .addEventListener("click", () =>
          document.getElementById("flashcard-all").classList.toggle("flipped")
        );

      document.getElementById("prev-btn").addEventListener("click", () => {
        if (currentCard > 0) {
          currentCard--;
          document.getElementById("flashcard").classList.remove("flipped");
          updateFlashcard();
        }
      });
      document.getElementById("next-btn").addEventListener("click", () => {
        if (currentCard < letterGroups[currentGroup].length - 1) {
          currentCard++;
          document.getElementById("flashcard").classList.remove("flipped");
          updateFlashcard();
        }
      });

      function updateFlashcard() {
        const data = letterGroups[currentGroup][currentCard];
        document.getElementById("card-letter").textContent = data.letter;
        document.getElementById("card-lowercase").textContent = data.lower;
        document.getElementById("card-sound").textContent = `"${data.sound}"`;
        document.getElementById("card-example").textContent = data.example;
        document.getElementById("card-trick").textContent = data.trick;
        document.getElementById(
          "card-badge"
        ).textContent = `Group ${currentGroup}`;
        document.getElementById("card-badge").style.background =
          groupColors[currentGroup];
        document.getElementById(
          "card-word-example"
        ).innerHTML = `<div class="cyrillic">${data.word}</div><div class="meaning">${data.wordLatin} = ${data.wordMeaning}</div>`;
        document.getElementById("progress-fill").style.width = `${
          ((currentCard + 1) / letterGroups[currentGroup].length) * 100
        }%`;
        document.getElementById("progress-text").textContent = `Card ${
          currentCard + 1
        } of ${letterGroups[currentGroup].length}`;
      }

      function updatePracticeWords() {
        document.getElementById("word-list").innerHTML = practiceWords[
          currentGroup
        ]
          .map(
            (w) =>
              `<div class="word-item"><div class="word-cyrillic">${w.cyrillic}</div><div class="word-info"><div class="word-latin">${w.latin}</div><div class="word-meaning">${w.meaning}</div></div></div>`
          )
          .join("");
      }

      // Flashcard all
      document.getElementById("fc-prev-btn").addEventListener("click", () => {
        if (fcIndex > 0) {
          fcIndex--;
          document.getElementById("flashcard-all").classList.remove("flipped");
          updateFlashcardAll();
        }
      });
      document.getElementById("fc-next-btn").addEventListener("click", () => {
        if (fcIndex < fcFilteredLetters.length - 1) {
          fcIndex++;
          document.getElementById("flashcard-all").classList.remove("flipped");
          updateFlashcardAll();
        }
      });
      document
        .getElementById("fc-restart-btn")
        .addEventListener("click", () => {
          fcIndex = 0;
          document.getElementById("flashcard-all").classList.remove("flipped");
          updateFlashcardAll();
        });
      document.getElementById("fc-shuffle-on").addEventListener("click", () => {
        fcShuffled = true;
        document.getElementById("fc-shuffle-on").classList.add("active");
        document.getElementById("fc-shuffle-off").classList.remove("active");
        updateFlashcardFiltered();
        fcIndex = 0;
        document.getElementById("flashcard-all").classList.remove("flipped");
        updateFlashcardAll();
      });
      document
        .getElementById("fc-shuffle-off")
        .addEventListener("click", () => {
          fcShuffled = false;
          document.getElementById("fc-shuffle-off").classList.add("active");
          document.getElementById("fc-shuffle-on").classList.remove("active");
          updateFlashcardFiltered();
          fcIndex = 0;
          document.getElementById("flashcard-all").classList.remove("flipped");
          updateFlashcardAll();
        });

      function updateFlashcardAll() {
        if (fcFilteredLetters.length === 0) {
          updateFlashcardFiltered();
        }
        const data = fcFilteredLetters[fcIndex];
        document.getElementById("fc-letter").textContent = data.letter;
        document.getElementById("fc-lowercase").textContent = data.lower;
        document.getElementById("fc-sound").textContent = `"${data.sound}"`;
        document.getElementById("fc-example").textContent = data.example;
        document.getElementById("fc-trick").textContent = data.trick;
        document.getElementById("fc-badge").textContent = `Group ${data.group}`;
        document.getElementById("fc-badge").style.background =
          groupColors[data.group];
        document.getElementById(
          "fc-word-example"
        ).innerHTML = `<div class="cyrillic">${data.word}</div><div class="meaning">${data.wordLatin} = ${data.wordMeaning}</div>`;
        document.getElementById("flashcard-counter").textContent = `${
          fcIndex + 1
        } / ${fcFilteredLetters.length}`;
      }

      // Quiz
      function resetQuiz() {
        quizLetters =
          quizGroup === "all"
            ? Object.values(letterGroups).flat()
            : [...letterGroups[parseInt(quizGroup)]];
        quizLetters.sort(() => Math.random() - 0.5);
        quizIndex = 0;
        correctAnswers = 0;
        totalAnswers = 0;
        incorrectLetters = [];
        quizAnsweredLetters = [];
        document.getElementById("score").textContent = "0/0";
        document.getElementById("quiz-summary").classList.add("hidden");
        document.getElementById("quiz-question").classList.remove("hidden");
        document.getElementById("quiz-options").classList.remove("hidden");
        document
          .getElementById("score")
          .parentElement.classList.remove("hidden");
        showQuizQuestion();
      }

      function showQuizQuestion() {
        // Clear any existing timeout
        if (autoAdvanceTimeout) {
          clearTimeout(autoAdvanceTimeout);
          autoAdvanceTimeout = null;
        }

        // Check if all letters have been answered
        if (quizAnsweredLetters.length >= quizLetters.length) {
          showQuizSummary();
          return;
        }

        // Find next unanswered letter from shuffled list
        let current = null;
        while (quizIndex < quizLetters.length) {
          const letter = quizLetters[quizIndex];
          if (!quizAnsweredLetters.includes(letter.letter)) {
            current = letter;
            break;
          }
          quizIndex++;
        }

        // If we couldn't find an unanswered letter, show summary
        if (!current) {
          showQuizSummary();
          return;
        }

        document.getElementById("quiz-letter").textContent = current.letter;
        const allSounds = [
          ...new Set(
            Object.values(letterGroups)
              .flat()
              .map((l) => l.sound)
          ),
        ];
        const wrongSounds = allSounds
          .filter((s) => s !== current.sound)
          .sort(() => Math.random() - 0.5)
          .slice(0, 3);
        const options = [current.sound, ...wrongSounds].sort(
          () => Math.random() - 0.5
        );
        document.getElementById("quiz-options").innerHTML = options
          .map(
            (s) =>
              `<button class="quiz-option" data-sound="${s}">"${s}"</button>`
          )
          .join("");
        document
          .querySelectorAll(".quiz-option")
          .forEach((btn) =>
            btn.addEventListener("click", () => checkAnswer(btn, current))
          );
      }

      let autoAdvanceTimeout = null;

      function checkAnswer(btn, currentLetter) {
        // Clear any existing timeout
        if (autoAdvanceTimeout) {
          clearTimeout(autoAdvanceTimeout);
        }

        const correctSound = currentLetter.sound;
        totalAnswers++;
        const isCorrect = btn.dataset.sound === correctSound;

        if (isCorrect) {
          correctAnswers++;
        } else {
          // Track incorrect answer
          incorrectLetters.push({
            letter: currentLetter.letter,
            lower: currentLetter.lower,
            sound: currentLetter.sound,
            example: currentLetter.example,
            word: currentLetter.word,
            wordLatin: currentLetter.wordLatin,
            wordMeaning: currentLetter.wordMeaning,
          });
        }

        // Mark this letter as answered
        if (!quizAnsweredLetters.includes(currentLetter.letter)) {
          quizAnsweredLetters.push(currentLetter.letter);
        }

        // Disable all options and show feedback
        document.querySelectorAll(".quiz-option").forEach((b) => {
          b.disabled = true;
          if (b.dataset.sound === correctSound) b.classList.add("correct");
          else if (b === btn) b.classList.add("wrong");
        });

        document.getElementById(
          "score"
        ).textContent = `${correctAnswers}/${totalAnswers}`;

        // Auto-advance after 2.5 seconds
        autoAdvanceTimeout = setTimeout(() => {
          quizIndex++;
          showQuizQuestion();
        }, 2500);
      }

      function showQuizSummary() {
        // Hide quiz question and options
        document.getElementById("quiz-question").classList.add("hidden");
        document.getElementById("quiz-options").classList.add("hidden");
        document.getElementById("score").parentElement.classList.add("hidden");

        // Show summary
        document.getElementById("quiz-summary").classList.remove("hidden");
        document.getElementById(
          "summary-score"
        ).textContent = `${correctAnswers}/${totalAnswers}`;

        let summaryHTML = "";

        if (incorrectLetters.length === 0) {
          summaryHTML = `
            <div class="score-display" style="background: rgba(16, 185, 129, 0.15); border: 2px solid var(--success); margin-bottom: 24px;">
              <div style="font-size: 2rem; margin-bottom: 12px;">üéâ Perfect!</div>
              <div style="color: var(--success); font-size: 1.1rem;">You got all answers correct!</div>
            </div>
          `;
        } else {
          summaryHTML = `
            <div style="background: var(--card-bg); border-radius: 16px; padding: 24px; margin-bottom: 24px;">
              <h3 style="color: var(--accent); margin-bottom: 16px; font-size: 1.2rem;">
                Letters to Review (${incorrectLetters.length})
              </h3>
              <div style="display: grid; gap: 12px;">
                ${incorrectLetters
                  .map(
                    (letter) => `
                  <div style="background: rgba(255, 255, 255, 0.03); border-radius: 12px; padding: 16px; border-left: 4px solid var(--error);">
                    <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 8px;">
                      <div style="font-size: 2.5rem; font-weight: 700;">${letter.letter}</div>
                      <div style="flex: 1;">
                        <div style="font-size: 1.1rem; color: var(--accent); font-weight: 600;">"${letter.sound}"</div>
                        <div style="font-size: 0.9rem; color: var(--text-muted); margin-top: 4px;">${letter.example}</div>
                      </div>
                    </div>
                    <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid rgba(255, 255, 255, 0.1);">
                      <div style="font-size: 1.2rem; font-weight: 600; margin-bottom: 4px;">${letter.word}</div>
                      <div style="font-size: 0.9rem; color: var(--text-muted);">${letter.wordLatin} = ${letter.wordMeaning}</div>
                    </div>
                  </div>
                `
                  )
                  .join("")}
              </div>
            </div>
          `;
        }

        document.getElementById("summary-content").innerHTML = summaryHTML;
      }

      document
        .getElementById("restart-quiz-btn")
        .addEventListener("click", () => {
          resetQuiz();
        });

      document.getElementById("new-group-btn").addEventListener("click", () => {
        // Reset and show first group
        document
          .querySelectorAll(".group-card[data-quiz]")
          .forEach((c) => c.classList.remove("selected"));
        const firstGroup = document.querySelector(
          ".group-card[data-quiz][data-group='1']"
        );
        if (firstGroup) {
          firstGroup.classList.add("selected");
          quizGroup = "1";
          resetQuiz();
        }
      });

      // Reference
      function renderReference() {
        for (let g = 1; g <= 5; g++) {
          document.getElementById(`ref-group${g}`).innerHTML = letterGroups[g]
            .map(
              (l) =>
                `<div class="letter-cell"><div class="cyrillic">${l.letter} ${l.lower}</div><div class="sound">"${l.sound}"</div></div>`
            )
            .join("");
        }
      }

      // Vocabulary
      function getVocabWords(cat) {
        if (cat === "all") return Object.values(vocabulary).flat();
        return vocabulary[cat] || [];
      }

      function renderVocab() {
        const words = getVocabWords(currentCategory);
        const search = document
          .getElementById("vocab-search")
          .value.toLowerCase();
        const filtered = words.filter(
          (w) =>
            w.mk.toLowerCase().includes(search) ||
            w.latin.toLowerCase().includes(search) ||
            w.en.toLowerCase().includes(search)
        );
        document.getElementById(
          "vocab-count"
        ).textContent = `${filtered.length} words`;
        document.getElementById("vocab-grid").innerHTML = filtered
          .map(
            (w) =>
              `<div class="vocab-card" onclick="this.classList.toggle('revealed')"><button class="speak-btn vocab-speak" onclick="event.stopPropagation(); speakMacedonian('${w.mk}')">üîä</button><div class="vocab-left"><div class="vocab-macedonian">${w.mk}</div><div class="vocab-latin">${w.latin}</div></div><div class="vocab-answer">${w.en}</div></div>`
          )
          .join("");
      }

      document.querySelectorAll(".category-tab").forEach((tab) => {
        tab.addEventListener("click", () => {
          document
            .querySelectorAll(".category-tab")
            .forEach((t) => t.classList.remove("active"));
          tab.classList.add("active");
          currentCategory = tab.dataset.category;
          renderVocab();
          resetVocabQuiz();
        });
      });

      document
        .getElementById("vocab-search")
        .addEventListener("input", renderVocab);

      document.getElementById("vocab-browse").addEventListener("click", () => {
        document.getElementById("vocab-browse").classList.add("active");
        document.getElementById("vocab-quiz-mode").classList.remove("active");
        document
          .getElementById("vocab-browse-container")
          .classList.remove("hidden");
        document.getElementById("vocab-quiz-container").classList.add("hidden");
      });

      document
        .getElementById("vocab-quiz-mode")
        .addEventListener("click", () => {
          document.getElementById("vocab-quiz-mode").classList.add("active");
          document.getElementById("vocab-browse").classList.remove("active");
          document
            .getElementById("vocab-browse-container")
            .classList.add("hidden");
          document
            .getElementById("vocab-quiz-container")
            .classList.remove("hidden");
          resetVocabQuiz();
        });

      function resetVocabQuiz() {
        vocabQuizWords = getVocabWords(currentCategory).sort(
          () => Math.random() - 0.5
        );
        vocabQuizIndex = 0;
        vocabCorrect = 0;
        vocabTotal = 0;
        document.getElementById("vocab-score").textContent = "0/0";
        showVocabQuestion();
      }

      function showVocabQuestion() {
        if (vocabQuizIndex >= vocabQuizWords.length) {
          vocabQuizIndex = 0;
          vocabQuizWords.sort(() => Math.random() - 0.5);
        }
        const word = vocabQuizWords[vocabQuizIndex];
        document.getElementById("vq-word").textContent = word.mk;
        document.getElementById("vq-latin").textContent = word.latin;
        document.getElementById("vq-input").value = "";
        document
          .getElementById("vq-input")
          .classList.remove("correct", "wrong");
        document.getElementById("vq-feedback").classList.add("hidden");
      }

      document.getElementById("vq-input").addEventListener("keypress", (e) => {
        if (e.key === "Enter") checkVocabAnswer();
      });

      document.getElementById("vq-show-btn").addEventListener("click", () => {
        const word = vocabQuizWords[vocabQuizIndex];
        const fb = document.getElementById("vq-feedback");
        fb.textContent = `Answer: ${word.en}`;
        fb.classList.remove("hidden", "correct");
        fb.classList.add("wrong");
        document.getElementById("vq-input").classList.add("wrong");
      });

      document.getElementById("vq-next-btn").addEventListener("click", () => {
        vocabQuizIndex++;
        showVocabQuestion();
      });

      function checkVocabAnswer() {
        const word = vocabQuizWords[vocabQuizIndex];
        const input = document.getElementById("vq-input");
        const fb = document.getElementById("vq-feedback");
        vocabTotal++;
        if (input.value.trim().toLowerCase() === word.en.toLowerCase()) {
          vocabCorrect++;
          input.classList.add("correct");
          fb.textContent = "‚úì Correct!";
          fb.classList.remove("hidden", "wrong");
          fb.classList.add("correct");
        } else {
          input.classList.add("wrong");
          fb.textContent = `‚úó The answer is: ${word.en}`;
          fb.classList.remove("hidden", "correct");
          fb.classList.add("wrong");
        }
        document.getElementById(
          "vocab-score"
        ).textContent = `${vocabCorrect}/${vocabTotal}`;
      }

      // Init
      updateFlashcard();
      updatePracticeWords();
      resetQuiz();
      updateFlashcardFiltered();
    </script>
  </body>
</html>
